/* 2016-11-24  by hqer*/function RSAKeyPair(a,b,c,d){this.e=biFromHex(a),this.d=biFromHex(b),this.m=biFromHex(c),"number"!=typeof d?this.chunkSize=2*biHighIndex(this.m):this.chunkSize=d/8,this.radix=16,this.barrett=new BarrettMu(this.m)}function encryptedString(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o=new Array,p=b.length,q="";for(h="string"==typeof c?c==RSAAPP.NoPadding?1:c==RSAAPP.PKCS1Padding?2:0:0,i="string"==typeof d&&d==RSAAPP.RawEncoding?1:0,1==h?p>a.chunkSize&&(p=a.chunkSize):2==h&&p>a.chunkSize-11&&(p=a.chunkSize-11),e=0,f=2==h?p-1:a.chunkSize-1;p>e;)h?o[f]=b.charCodeAt(e):o[e]=b.charCodeAt(e),e++,f--;for(1==h&&(e=0),f=a.chunkSize-p%a.chunkSize;f>0;){if(2==h){for(j=Math.floor(256*Math.random());!j;)j=Math.floor(256*Math.random());o[e]=j}else o[e]=0;e++,f--}for(2==h&&(o[p]=0,o[a.chunkSize-2]=2,o[a.chunkSize-1]=0),k=o.length,e=0;k>e;e+=a.chunkSize){for(l=new BigInt,f=0,g=e;g<e+a.chunkSize;++f)l.digits[f]=o[g++],l.digits[f]+=o[g++]<<8;m=a.barrett.powMod(l,a.e),n=1==i?biToBytes(m):16==a.radix?biToHex(m):biToString(m,a.radix),q+=n}return q}function decryptedString(a,b){var c,d,e,f,g=b.split(" "),h="";for(d=0;d<g.length;++d)for(f=16==a.radix?biFromHex(g[d]):biFromString(g[d],a.radix),c=a.barrett.powMod(f,a.d),e=0;e<=biHighIndex(c);++e)h+=String.fromCharCode(255&c.digits[e],c.digits[e]>>8);return 0==h.charCodeAt(h.length-1)&&(h=h.substring(0,h.length-1)),h}var RSAAPP={};RSAAPP.NoPadding="NoPadding",RSAAPP.PKCS1Padding="PKCS1Padding",RSAAPP.RawEncoding="RawEncoding",RSAAPP.NumericEncoding="NumericEncoding";