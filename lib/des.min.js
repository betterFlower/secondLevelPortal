/* 2016-11-24  by hqer*/function strEnc(a,b,c,d){var e,f,g,h,i,j,k=a.length,l="";if(null!=b&&""!=b&&(e=getKeyBytes(b),h=e.length),null!=c&&""!=c&&(f=getKeyBytes(c),i=f.length),null!=d&&""!=d&&(g=getKeyBytes(d),j=g.length),k>0)if(4>k){var m,n=strToBt(a);if(null!=b&&""!=b&&null!=c&&""!=c&&null!=d&&""!=d){var o,p,q,r;for(o=n,p=0;h>p;p++)o=enc(o,e[p]);for(q=0;i>q;q++)o=enc(o,f[q]);for(r=0;j>r;r++)o=enc(o,g[r]);m=o}else if(null!=b&&""!=b&&null!=c&&""!=c){var o,p,q;for(o=n,p=0;h>p;p++)o=enc(o,e[p]);for(q=0;i>q;q++)o=enc(o,f[q]);m=o}else if(null!=b&&""!=b){var o,p=0;for(o=n,p=0;h>p;p++)o=enc(o,e[p]);m=o}l=bt64ToHex(m)}else{var s=parseInt(k/4),t=k%4,u=0;for(u=0;s>u;u++){var m,v=a.substring(4*u+0,4*u+4),w=strToBt(v);if(null!=b&&""!=b&&null!=c&&""!=c&&null!=d&&""!=d){var o,p,q,r;for(o=w,p=0;h>p;p++)o=enc(o,e[p]);for(q=0;i>q;q++)o=enc(o,f[q]);for(r=0;j>r;r++)o=enc(o,g[r]);m=o}else if(null!=b&&""!=b&&null!=c&&""!=c){var o,p,q;for(o=w,p=0;h>p;p++)o=enc(o,e[p]);for(q=0;i>q;q++)o=enc(o,f[q]);m=o}else if(null!=b&&""!=b){var o,p;for(o=w,p=0;h>p;p++)o=enc(o,e[p]);m=o}l+=bt64ToHex(m)}if(t>0){var m,x=a.substring(4*s+0,k),w=strToBt(x);if(null!=b&&""!=b&&null!=c&&""!=c&&null!=d&&""!=d){var o,p,q,r;for(o=w,p=0;h>p;p++)o=enc(o,e[p]);for(q=0;i>q;q++)o=enc(o,f[q]);for(r=0;j>r;r++)o=enc(o,g[r]);m=o}else if(null!=b&&""!=b&&null!=c&&""!=c){var o,p,q;for(o=w,p=0;h>p;p++)o=enc(o,e[p]);for(q=0;i>q;q++)o=enc(o,f[q]);m=o}else if(null!=b&&""!=b){var o,p;for(o=w,p=0;h>p;p++)o=enc(o,e[p]);m=o}l+=bt64ToHex(m)}}return l}function strDec(a,b,c,d){var e,f,g,h,i,j,k=a.length,l="";null!=b&&""!=b&&(e=getKeyBytes(b),h=e.length),null!=c&&""!=c&&(f=getKeyBytes(c),i=f.length),null!=d&&""!=d&&(g=getKeyBytes(d),j=g.length);var m=parseInt(k/16),n=0;for(n=0;m>n;n++){var o=a.substring(16*n+0,16*n+16),p=hexToBt64(o),q=new Array(64),r=0;for(r=0;64>r;r++)q[r]=parseInt(p.substring(r,r+1));var s;if(null!=b&&""!=b&&null!=c&&""!=c&&null!=d&&""!=d){var t,u,v,w;for(t=q,u=j-1;u>=0;u--)t=dec(t,g[u]);for(v=i-1;v>=0;v--)t=dec(t,f[v]);for(w=h-1;w>=0;w--)t=dec(t,e[w]);s=t}else if(null!=b&&""!=b&&null!=c&&""!=c){var t,u,v,w;for(t=q,u=i-1;u>=0;u--)t=dec(t,f[u]);for(v=h-1;v>=0;v--)t=dec(t,e[v]);s=t}else if(null!=b&&""!=b){var t,u,v,w;for(t=q,u=h-1;u>=0;u--)t=dec(t,e[u]);s=t}l+=byteToString(s)}return l}function getKeyBytes(a){var b=new Array,c=a.length,d=parseInt(c/4),e=c%4,f=0;for(f=0;d>f;f++)b[f]=strToBt(a.substring(4*f+0,4*f+4));return e>0&&(b[f]=strToBt(a.substring(4*f+0,c))),b}function strToBt(a){var b=a.length,c=new Array(64);if(4>b){var d=0,e=0,f=0,g=0;for(d=0;b>d;d++){var h=a.charCodeAt(d);for(e=0;16>e;e++){var i=1,j=0;for(j=15;j>e;j--)i*=2;c[16*d+e]=parseInt(h/i)%2}}for(f=b;4>f;f++){var h=0;for(g=0;16>g;g++){var i=1,j=0;for(j=15;j>g;j--)i*=2;c[16*f+g]=parseInt(h/i)%2}}}else for(d=0;4>d;d++){var h=a.charCodeAt(d);for(e=0;16>e;e++){var i=1;for(j=15;j>e;j--)i*=2;c[16*d+e]=parseInt(h/i)%2}}return c}function bt4ToHex(a){var b;switch(a){case"0000":b="0";break;case"0001":b="1";break;case"0010":b="2";break;case"0011":b="3";break;case"0100":b="4";break;case"0101":b="5";break;case"0110":b="6";break;case"0111":b="7";break;case"1000":b="8";break;case"1001":b="9";break;case"1010":b="A";break;case"1011":b="B";break;case"1100":b="C";break;case"1101":b="D";break;case"1110":b="E";break;case"1111":b="F"}return b}function hexToBt4(a){var b;switch(a){case"0":b="0000";break;case"1":b="0001";break;case"2":b="0010";break;case"3":b="0011";break;case"4":b="0100";break;case"5":b="0101";break;case"6":b="0110";break;case"7":b="0111";break;case"8":b="1000";break;case"9":b="1001";break;case"A":b="1010";break;case"B":b="1011";break;case"C":b="1100";break;case"D":b="1101";break;case"E":b="1110";break;case"F":b="1111"}return b}function byteToString(a){var b="";for(i=0;i<4;i++){var c=0;for(j=0;j<16;j++){var d=1;for(m=15;m>j;m--)d*=2;c+=a[16*i+j]*d}0!=c&&(b+=String.fromCharCode(c))}return b}function bt64ToHex(a){var b="";for(i=0;i<16;i++){var c="";for(j=0;j<4;j++)c+=a[4*i+j];b+=bt4ToHex(c)}return b}function hexToBt64(a){var b="";for(i=0;i<16;i++)b+=hexToBt4(a.substring(i,i+1));return b}function enc(a,b){var c=generateKeys(b),d=initPermute(a),e=new Array(32),f=new Array(32),g=new Array(32),h=0,i=0,j=0,k=0,l=0;for(j=0;32>j;j++)e[j]=d[j],f[j]=d[32+j];for(h=0;16>h;h++){for(i=0;32>i;i++)g[i]=e[i],e[i]=f[i];var m=new Array(48);for(k=0;48>k;k++)m[k]=c[h][k];var n=xor(pPermute(sBoxPermute(xor(expandPermute(f),m))),g);for(l=0;32>l;l++)f[l]=n[l]}var o=new Array(64);for(h=0;32>h;h++)o[h]=f[h],o[32+h]=e[h];return finallyPermute(o)}function dec(a,b){var c=generateKeys(b),d=initPermute(a),e=new Array(32),f=new Array(32),g=new Array(32),h=0,i=0,j=0,k=0,l=0;for(j=0;32>j;j++)e[j]=d[j],f[j]=d[32+j];for(h=15;h>=0;h--){for(i=0;32>i;i++)g[i]=e[i],e[i]=f[i];var m=new Array(48);for(k=0;48>k;k++)m[k]=c[h][k];var n=xor(pPermute(sBoxPermute(xor(expandPermute(f),m))),g);for(l=0;32>l;l++)f[l]=n[l]}var o=new Array(64);for(h=0;32>h;h++)o[h]=f[h],o[32+h]=e[h];return finallyPermute(o)}function initPermute(a){var b=new Array(64);for(i=0,m=1,n=0;i<4;i++,m+=2,n+=2)for(j=7,k=0;j>=0;j--,k++)b[8*i+k]=a[8*j+m],b[8*i+k+32]=a[8*j+n];return b}function expandPermute(a){var b=new Array(48);for(i=0;i<8;i++)0==i?b[6*i+0]=a[31]:b[6*i+0]=a[4*i-1],b[6*i+1]=a[4*i+0],b[6*i+2]=a[4*i+1],b[6*i+3]=a[4*i+2],b[6*i+4]=a[4*i+3],7==i?b[6*i+5]=a[0]:b[6*i+5]=a[4*i+4];return b}function xor(a,b){var c=new Array(a.length);for(i=0;i<a.length;i++)c[i]=a[i]^b[i];return c}function sBoxPermute(a){var b=new Array(32),c="",d=[[14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7],[0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8],[4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0],[15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,13]],e=[[15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10],[3,13,4,7,15,2,8,14,12,0,1,10,6,9,11,5],[0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15],[13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9]],f=[[10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8],[13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1],[13,6,4,9,8,15,3,0,11,1,2,12,5,10,14,7],[1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12]],g=[[7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15],[13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9],[10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4],[3,15,0,6,10,1,13,8,9,4,5,11,12,7,2,14]],h=[[2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9],[14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6],[4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14],[11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3]],i=[[12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11],[10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8],[9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6],[4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13]],j=[[4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1],[13,0,11,7,4,9,1,10,14,3,5,12,2,15,8,6],[1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2],[6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12]],k=[[13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7],[1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2],[7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8],[2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11]];for(m=0;m<8;m++){var l=0,n=0;switch(l=2*a[6*m+0]+a[6*m+5],n=2*a[6*m+1]*2*2+2*a[6*m+2]*2+2*a[6*m+3]+a[6*m+4],m){case 0:c=getBoxBinary(d[l][n]);break;case 1:c=getBoxBinary(e[l][n]);break;case 2:c=getBoxBinary(f[l][n]);break;case 3:c=getBoxBinary(g[l][n]);break;case 4:c=getBoxBinary(h[l][n]);break;case 5:c=getBoxBinary(i[l][n]);break;case 6:c=getBoxBinary(j[l][n]);break;case 7:c=getBoxBinary(k[l][n])}b[4*m+0]=parseInt(c.substring(0,1)),b[4*m+1]=parseInt(c.substring(1,2)),b[4*m+2]=parseInt(c.substring(2,3)),b[4*m+3]=parseInt(c.substring(3,4))}return b}function pPermute(a){var b=new Array(32);return b[0]=a[15],b[1]=a[6],b[2]=a[19],b[3]=a[20],b[4]=a[28],b[5]=a[11],b[6]=a[27],b[7]=a[16],b[8]=a[0],b[9]=a[14],b[10]=a[22],b[11]=a[25],b[12]=a[4],b[13]=a[17],b[14]=a[30],b[15]=a[9],b[16]=a[1],b[17]=a[7],b[18]=a[23],b[19]=a[13],b[20]=a[31],b[21]=a[26],b[22]=a[2],b[23]=a[8],b[24]=a[18],b[25]=a[12],b[26]=a[29],b[27]=a[5],b[28]=a[21],b[29]=a[10],b[30]=a[3],b[31]=a[24],b}function finallyPermute(a){var b=new Array(64);return b[0]=a[39],b[1]=a[7],b[2]=a[47],b[3]=a[15],b[4]=a[55],b[5]=a[23],b[6]=a[63],b[7]=a[31],b[8]=a[38],b[9]=a[6],b[10]=a[46],b[11]=a[14],b[12]=a[54],b[13]=a[22],b[14]=a[62],b[15]=a[30],b[16]=a[37],b[17]=a[5],b[18]=a[45],b[19]=a[13],b[20]=a[53],b[21]=a[21],b[22]=a[61],b[23]=a[29],b[24]=a[36],b[25]=a[4],b[26]=a[44],b[27]=a[12],b[28]=a[52],b[29]=a[20],b[30]=a[60],b[31]=a[28],b[32]=a[35],b[33]=a[3],b[34]=a[43],b[35]=a[11],b[36]=a[51],b[37]=a[19],b[38]=a[59],b[39]=a[27],b[40]=a[34],b[41]=a[2],b[42]=a[42],b[43]=a[10],b[44]=a[50],b[45]=a[18],b[46]=a[58],b[47]=a[26],b[48]=a[33],b[49]=a[1],b[50]=a[41],b[51]=a[9],b[52]=a[49],b[53]=a[17],b[54]=a[57],b[55]=a[25],b[56]=a[32],b[57]=a[0],b[58]=a[40],b[59]=a[8],b[60]=a[48],b[61]=a[16],b[62]=a[56],b[63]=a[24],b}function getBoxBinary(a){var b="";switch(a){case 0:b="0000";break;case 1:b="0001";break;case 2:b="0010";break;case 3:b="0011";break;case 4:b="0100";break;case 5:b="0101";break;case 6:b="0110";break;case 7:b="0111";break;case 8:b="1000";break;case 9:b="1001";break;case 10:b="1010";break;case 11:b="1011";break;case 12:b="1100";break;case 13:b="1101";break;case 14:b="1110";break;case 15:b="1111"}return b}function generateKeys(a){var b=new Array(56),c=new Array;c[0]=new Array,c[1]=new Array,c[2]=new Array,c[3]=new Array,c[4]=new Array,c[5]=new Array,c[6]=new Array,c[7]=new Array,c[8]=new Array,c[9]=new Array,c[10]=new Array,c[11]=new Array,c[12]=new Array,c[13]=new Array,c[14]=new Array,c[15]=new Array;var d=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];for(e=0;7>e;e++)for(j=0,k=7;j<8;j++,k--)b[8*e+j]=a[8*k+e];var e=0;for(e=0;16>e;e++){var f=0,g=0;for(j=0;j<d[e];j++){for(f=b[0],g=b[28],k=0;k<27;k++)b[k]=b[k+1],b[28+k]=b[29+k];b[27]=f,b[55]=g}var h=new Array(48);switch(h[0]=b[13],h[1]=b[16],h[2]=b[10],h[3]=b[23],h[4]=b[0],h[5]=b[4],h[6]=b[2],h[7]=b[27],h[8]=b[14],h[9]=b[5],h[10]=b[20],h[11]=b[9],h[12]=b[22],h[13]=b[18],h[14]=b[11],h[15]=b[3],h[16]=b[25],h[17]=b[7],h[18]=b[15],h[19]=b[6],h[20]=b[26],h[21]=b[19],h[22]=b[12],h[23]=b[1],h[24]=b[40],h[25]=b[51],h[26]=b[30],h[27]=b[36],h[28]=b[46],h[29]=b[54],h[30]=b[29],h[31]=b[39],h[32]=b[50],h[33]=b[44],h[34]=b[32],h[35]=b[47],h[36]=b[43],h[37]=b[48],h[38]=b[38],h[39]=b[55],h[40]=b[33],h[41]=b[52],h[42]=b[45],h[43]=b[41],h[44]=b[49],h[45]=b[35],h[46]=b[28],h[47]=b[31],e){case 0:for(m=0;m<48;m++)c[0][m]=h[m];break;case 1:for(m=0;m<48;m++)c[1][m]=h[m];break;case 2:for(m=0;m<48;m++)c[2][m]=h[m];break;case 3:for(m=0;m<48;m++)c[3][m]=h[m];break;case 4:for(m=0;m<48;m++)c[4][m]=h[m];break;case 5:for(m=0;m<48;m++)c[5][m]=h[m];break;case 6:for(m=0;m<48;m++)c[6][m]=h[m];break;case 7:for(m=0;m<48;m++)c[7][m]=h[m];break;case 8:for(m=0;m<48;m++)c[8][m]=h[m];break;case 9:for(m=0;m<48;m++)c[9][m]=h[m];break;case 10:for(m=0;m<48;m++)c[10][m]=h[m];break;case 11:for(m=0;m<48;m++)c[11][m]=h[m];break;case 12:for(m=0;m<48;m++)c[12][m]=h[m];break;case 13:for(m=0;m<48;m++)c[13][m]=h[m];break;case 14:for(m=0;m<48;m++)c[14][m]=h[m];break;case 15:for(m=0;m<48;m++)c[15][m]=h[m]}}return c}